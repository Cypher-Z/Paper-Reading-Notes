# 网络安全协议的形式化验证与分析

[Last update: 21.03.30]

## 绪论

### 安全协议概述

协议安全的几类重要特性：机密性、完整性、权威性（认证性）、公平性、不可否认性、原子性、匿名性、可用性、可追究性。

常见的攻击类型：中间人攻击、重放攻击、并行回话攻击、反射攻击、Oracle攻击等。

形式化分析的流派：计算流派（随机预言机模型）、逻辑符号流派。

### 形式化技术基础

* **模态逻辑技术**

首先要对协议涉及到的对象、状态、关系进行逻辑抽象。优点：简单、计算效率快、自动执行；缺点：抽象程度高，无法对协议的某些细节进行验证。

**Key idea**：安全协议执行之前，主体拥有一定的信念和知识；安全协议执行的过程是主体不断运用逻辑推理获取新的信念和知识的过程；安全属性也是信念和知识，是否属于安全协议要看协议执行完毕时，主体是否能够推导得到安全属性。

* **模型检测技术**

优点：自动化程度高、能自动生成攻击案例；缺点: 只能分析有限状态系统，可能存在搜索空间爆炸的情况。

**Key idea：**将安全协议看做是分布式系统，单个主体涉及的协议执行部分称为局部状态，所有局部状态构成全局状态。安全属性是定义在全局的某个安全属性或者不变关系。协议是否满足安全性，就要看在所有可能的全局状态中，安全属性或者不变关系是否被满足。

常见的模型检测技术包括：有限状态机、Petri网和通信进程演算。

* **定理证明技术**

将安全协议描述为公理系统（一般通过人工分析进行）。能覆盖无限空间，但是不好操作。

### 形式化方法在安全协议验证中的应用

目前大概分为：用形式化方法找到攻击/漏洞、采取形式化的方法设计协议（以保障其安全性）以及进行协议形式化工具的研发。

未来的发展趋势：1）更抽象的密码学原语；2）新的威胁类型的形式化建模；3）复杂协议的保真分解；4）分析的高保真。

## 基于模态逻辑技术的安全协议分析方法

